---
title: Pytest6-è‡ªå®šä¹‰æ ‡è®°mark
date: 2021-06-29  23:45
tags: Pytest
categories: Pythonå­¦ä¹ 

---

## å‰è¨€

åœ¨pytestä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨markè¿›è¡Œç”¨ä¾‹çš„è‡ªå®šä¹‰æ ‡è®°ï¼Œé€šè¿‡ä¸åŒçš„æ ‡è®°å®ç°ä¸åŒçš„è¿è¡Œç­–ç•¥

æ¯”å¦‚æˆ‘ä»¬å¯ä»¥æ ‡è®°å“ªäº›ç”¨ä¾‹æ˜¯ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œçš„ï¼Œå“ªäº›ç”¨ä¾‹æ˜¯æµ‹è¯•ç¯å¢ƒæ‰§è¡Œçš„ï¼Œåœ¨è¿è¡Œä»£ç çš„æ—¶å€™æŒ‡å®šå¯¹åº”çš„markå³å¯

<!-- more -->

## å®ä¾‹è¯´æ˜

ä¸¾ä¸ªğŸŒ°

```python
# test_demo.py
import pytest

@pytest.mark.production
def test_production():
    print("ç”Ÿäº§ç¯å¢ƒæµ‹è¯•ç”¨ä¾‹")


@pytest.mark.dev
def test_dev1():
    print("æµ‹è¯•ç¯å¢ƒæµ‹è¯•ç”¨ä¾‹1")


@pytest.mark.dev
def test_dev2():
    print("æµ‹è¯•ç¯å¢ƒæµ‹è¯•ç”¨ä¾‹2")


def testnoMark():
    print("æ²¡æœ‰æ ‡è®°æµ‹è¯•")
```

ä½¿ç”¨å‘½ä»¤`pytest -s -m dev test_demo.py`æ‰§è¡Œ

ç»“æœå¦‚ä¸‹

![image-20210629224049942](https://img.rockche.cn//image-20210629224049942.png)

å¯ä»¥çœ‹åˆ°ï¼Œåªæ‰§è¡Œäº†ä¸¤æ¡æ ‡è®°äº†devçš„ç”¨ä¾‹

### å¤„ç†warningsä¿¡æ¯

- åˆ›å»ºä¸€ä¸ªpytest.iniæ–‡ä»¶

- ç„¶ååœ¨ pytest.ini æ–‡ä»¶çš„ markers ä¸­å†™å…¥ä½ çš„ mark æ ‡è®°ï¼Œ å†’å· â€œ:â€ å‰é¢æ˜¯æ ‡è®°åç§°ï¼Œåé¢æ˜¯ mark æ ‡è®°çš„è¯´æ˜ï¼Œå¯ä»¥æ˜¯ç©ºå­—ç¬¦ä¸²

- **æ³¨æ„ï¼š**pytest.iniéœ€è¦å’Œè¿è¡Œçš„æµ‹è¯•ç”¨ä¾‹åŒä¸€ä¸ªç›®å½•ï¼Œæˆ–åœ¨æ ¹ç›®å½•ä¸‹ä½œç”¨äºå…¨å±€

  ![image-20210629224639064](https://img.rockche.cn//image-20210629224639064.png)

### è§„èŒƒä½¿ç”¨markæ ‡è®°

æ·»åŠ äº†pytest.iniæ–‡ä»¶ä¹‹å pytest ä¾¿ä¸ä¼šå†å‘Šè­¦ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨è¿è¡Œç”¨ä¾‹çš„æ—¶å€™å†™é”™äº† mark åï¼Œä¼šå¯¼è‡´ pytest æ‰¾ä¸åˆ°ç”¨ä¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ pytest.ini æ–‡ä»¶ä¸­æ·»åŠ å‚æ•° `â€œaddopts = --strict-markersâ€`æ¥ä¸¥æ ¼è§„èŒƒ mark æ ‡è®°çš„ä½¿ç”¨

![image-20210629232426057](https://img.rockche.cn//image-20210629232426057.png)

æ·»åŠ è¯¥å‚æ•°åï¼Œå½“ä½¿ç”¨æœªæ³¨å†Œçš„ mark æ ‡è®°æ—¶ï¼Œpytestä¼šç›´æ¥æŠ¥é”™ï¼šâ€œ `'xxx' not found in markers configuration option` â€ï¼Œä¸æ‰§è¡Œæµ‹è¯•ä»»åŠ¡

![image-20210629232320091](https://img.rockche.cn//image-20210629232320091.png)

### æ‰§è¡Œæ ‡è®°ä»¥å¤–çš„ç”¨ä¾‹

> `pytest -s -m "not dev" test_demo.py`

ç»“æœå¦‚ä¸‹

![image-20210629225046830](https://img.rockche.cn//image-20210629225046830.png)

### æ‰§è¡Œå¤šä¸ªè‡ªå®šä¹‰æ ‡è®°çš„ç”¨ä¾‹

> `pytest -s -m "dev or production" test_demo.py`

ç»“æœå¦‚ä¸‹

![image-20210629225222295](https://img.rockche.cn//image-20210629225222295.png)